\documentclass{beamer}

\usepackage[utf8]{inputenc}

\usetheme{Warsaw}


\title{Source Location}
\author{listenzcc \inst{1}}
\institute[VFU] % (optional)
{
  \inst{1}
  Very Famous University
}

\date{\today}

\begin{document}

\frame{\titlepage}

\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[hideallsubsections]
\end{frame}

\section{Prepare Knowledge}
\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection, hideothersubsections]
\end{frame}
\subsection{Definition}

\begin{frame}
    \frametitle{Scalar and vector field}
    A function of space is known as a field.
    Let an arbitrary 3-D coordinate system be given.

    \begin{block}{Scalar field}
        If to each position $x = (x_{1}, x_{2}, x_{3})$ of a region in space, it corresponds a scalar $\phi (x_{1}, x_{2}, x_{3})$, then $\phi$ is called a \emph{scalar field}.

        Like \emph{density} field.
    \end{block}

    \begin{block}{Vector field}
        If to each position $x = (x_{1}, x_{2}, x_{3})$ of a region in space, it corresponds a vector $\vec{a} (x_{1}, x_{2}, x_{3})$, then $\vec{a}$ is called a \emph{vector field}.

        Like \emph{velocity} field.
    \end{block}

    How does scalar or vector field change along spatial dimensions?
\end{frame}

\begin{frame}
    \frametitle{Scalar and vector field}
    An example of scalar (\emph{temperature}) and vector (\emph{heat transfer}) field.
    \begin{figure}[H]
        \centering
        \includegraphics[height=0.5\textheight]{heatmap.png}
        \caption{Heat Map. left: temperature, right: heat transfer}
        \label{fig: Heat map}
    \end{figure}
\end{frame}


\subsection{Operators}

\begin{frame}
    \frametitle{Nabla operator $\nabla$}
    Partial derivatives is an useful tool to measure the changes along spatial dimensions.

    For scalar field
    \begin{equation}
        \partial_{i} \phi = \frac{\partial}{\partial x_{i}} \phi
    \end{equation}

    For vector field
    \begin{equation}
        (\partial_{i} \vec{a}) (\vec{r}) = \lim_{\Delta x_{i} \rightarrow 0} \frac{\vec{a}(\vec{r} + \Delta x_{i} \vec{e}_{i}) - \vec{a}(\vec{r})}{\Delta x_{i}}
    \end{equation}

    To simplify the partial derivatives, we imply \emph{Nabla operator}.
    \begin{alertblock}{Nabla operator}
        \begin{equation}
            \nabla (\cdot) = \sum_{i} \vec{e}_{i} \partial_{i} (\cdot)
        \end{equation}
    \end{alertblock}

\end{frame}

\begin{frame}
    \frametitle{Gradient, divergence, curl}

    \begin{block}{Gradient}
        \begin{equation}
            grad \phi = \nabla \phi = \sum_{i} \vec{e}_{i} \partial_{i} \phi
        \end{equation}
    \end{block}

    \begin{block}{Divergence}
        \begin{equation}
            div \vec{a} = \nabla \vec{a} = \sum_{i} \partial_{i} \vec{a}
        \end{equation}
    \end{block}

    \begin{block}{Curl}
        \begin{equation}
            curl \vec{a} = \nabla \times \vec{a} = det
            \begin{pmatrix}
                \vec{e}_{1}  & \vec{e}_{1}  & \vec{e}_{1}  \\
                \partial_{1} & \partial_{1} & \partial_{1} \\
                \vec{a}_{1}  & \vec{a}_{1}  & \vec{a}_{1}
            \end{pmatrix}
        \end{equation}
    \end{block}

\end{frame}

\section{Maxwell Equations}

\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection, hideothersubsections]
\end{frame}

\subsection{Definition}
\begin{frame}
    \frametitle{Definition}
    Maxwell Equations describe the dynamic of Electromagnetic Wave.
    \begin{columns}

        \column{0.5\textwidth}
        \begin{equation}
            \nabla \cdot \vec{D} = \rho
            \label{eq: me D}
        \end{equation}
        \begin{equation}
            \nabla \cdot \vec{B} = 0
            \label{eq: me B}
        \end{equation}
        \begin{equation}
            \nabla \times \vec{E} = - \frac{\partial{\vec{B}}}{\partial{t}}
            \label{eq: me E}
        \end{equation}
        \begin{equation}
            \nabla \times \vec{H} = \frac{\partial{\vec{D}}}{\partial{t}} + \vec{J}
            \label{eq: me H}
        \end{equation}

        \column{0.5\textwidth}
        \begin{table}[h]
            \centering
            \caption{Meaning}
            \begin{tabular}{|c|l|}
                \hline
                $\vec{D}$ & Electric Flux Density   \\\hline
                $\vec{B}$ & Magnetic Flux Density   \\\hline
                $\vec{E}$ & Electric Field          \\\hline
                $\vec{H}$ & Magnetic Field          \\\hline
                $\vec{J}$ & Current Density         \\\hline
                $\rho$    & Electric Charge Density \\
                \hline
            \end{tabular}
        \end{table}

    \end{columns}

    \vspace{5mm}
    where $\vec{B} = \mu \vec{H}$, $\vec{D} = \epsilon \vec{E}$.
\end{frame}

\begin{frame}
    \frametitle{Explaining}
    The meaning of Maxwell equations is quite intuitive
    \begin{itemize}
        \item Electric Charge Density produces Electric Flux Density (\ref{eq: me D})
        \item Magnetic Flux Density is non-source field (\ref{eq: me B})
        \item Changing Magnetic Flux Density produces Electric Field (\ref{eq: me E})
        \item Changing Electric Flux Density or Current Density produces Magnetic Field (\ref{eq: me H})
    \end{itemize}

\end{frame}
\subsection{Example}
\begin{frame}
    \frametitle{Example}
    In vacuum space, the Maxwell Equations are re-written as
    \begin{equation}
        \nabla \cdot \vec{E} = 0
    \end{equation}
    \begin{equation}
        \nabla \times \vec{E} = - \frac{\partial{\vec{B}}}{\partial{t}}
    \end{equation}
    \begin{equation}
        \nabla \cdot \vec{B} = 0
    \end{equation}
    \begin{equation}
        \nabla \times \vec{B} = \mu_{0} \epsilon_{0} \frac{\partial{\vec{E}}}{\partial{t}}
    \end{equation}
\end{frame}

\begin{frame}
    \frametitle{Example}
    $\vec{E}$ and $\vec{B}$ is almost symmetry.
    \begin{equation}
        \nabla \times (\nabla \times \vec{E}) =
        - \mu_{0} \epsilon_{0} \frac{\partial^{2}}{\partial{t^{2}}} \vec{E}
    \end{equation}
    \begin{equation}
        \nabla \times (\nabla \times \vec{B}) = - \mu_{0} \epsilon_{0} \frac{\partial^{2}}{\partial{t^{2}}} \vec{B}
    \end{equation}
    use
    \begin{equation}
        \nabla \times (\nabla \times \vec{X}) =
        \nabla \cdot (\nabla \cdot \vec{X}) - \nabla^{2} \vec{X}
    \end{equation}
    we have
    \begin{equation}
        \nabla^{2} \vec{X} = \mu_{0} \epsilon_{0} \frac{\partial^{2}}{\partial{t^{2}}} \vec{X}
    \end{equation}
    Solve the wave function, the wave speed is $c=\frac{1}{\sqrt{\mu_{0} \epsilon_{0}}}$.\footnote{$\mu_{0}=8. 854187817 \times 10^{-12} F/m$, $\epsilon_{0}=4 \pi \times 10^{-7} N/A^{2}$}
\end{frame}

\section{Forward and Backward Process}

\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection, hideothersubsections]
\end{frame}

\subsection{Forward process}
\begin{frame}
    \frametitle{Forward process}
    \begin{columns}
        \column{0.5\textwidth}
        Volume conductor
        \begin{itemize}
            \item Scalp
            \item Skull
            \item CSF
            \item Grey matter
            \item White matter
            \item Air pockets
            \item Conductivity tensor
        \end{itemize}

        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.5\textheight]{skull.png}
            \caption{Skull}
            \label{fig:Skull}
        \end{figure}

    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Forward process}
    \begin{columns}
        \column{0.5\textwidth}
        Source model
        \begin{itemize}
            \item Neurons â€“ brain cells, building blocks
            \item Pyramidal cells $10^{-5} per mm$ in cortex
            \item Send electric impulse (action potential $~20fA$ per synapse)
            \item $40 mm^{2}$ of active cortex
            \item Current $I_{0} = 10 nA$
            \item Source  decays  $d = 0.1 mm$
            \item Current dipole $P = I_{0} * d$
        \end{itemize}

        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.5\textheight]{source_model.png}
            \caption{Source model}
            \label{fig:Source model}
        \end{figure}

    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Forward process}
    \begin{columns}
        \column{0.5\textwidth}
        Physical model
        \begin{itemize}
            \item Head is a volume conductor
            \item Concentrated current source (intra-cellular currents)
            \item Passive return volume currents (extra-cellular currents)
                  \begin{equation*}
                      \vec{J} = \vec{J_{i}} + \vec{J_{e}}
                  \end{equation*}
            \item No flux boundary conditions
                  \begin{equation*}
                      (\vec{J_{1}} - \vec{J_{2}}) \cdot \vec{n} = 0
                  \end{equation*}
        \end{itemize}

        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.5\textheight]{physical_model.png}
            \caption{Physical model}
            \label{fig: Physical model}
        \end{figure}

    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Forward process}
    Forward problem solution
    \begin{columns}
        \column{0.5\textwidth}
        \begin{itemize}
            \item Estimate the potential on the skull surface
            \item Knowing the currents beneath the skull
        \end{itemize}

        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.5\textheight]{forward_solution.png}
            \caption{Forward solution}
            \label{fig: Forward solution}
        \end{figure}

    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Mathematical model}
    Poisson equation
    \begin{equation}
        \nabla \cdot (\sigma \nabla \Phi) = \sum \vec{I_{s}}, \vec{I_{s}} in \Omega
    \end{equation}
    Neumann boundary conditions
    \begin{equation}
        \sigma (\nabla \Phi) \cdot n = 0
    \end{equation}
    Dipole current source
    \begin{equation}
        I_{s}(\vec{r}) = \lim_{d \rightarrow 0} \vec{I_{0}}
        ( \delta (\vec{r} - \vec{r_{s}} - \frac{d}{2}) - \delta (\vec{r} - \vec{r_{s}} + \frac{d}{2}) )
    \end{equation}
\end{frame}

\begin{frame}
    \frametitle{Forward estimation}
    The forward solution is exampled as following
    \begin{figure}[H]
        \centering
        \includegraphics[height=0.5\textheight]{Forward_estimation.png}
        \caption{Forward estimation}
        \label{fig: Forward estimation}
    \end{figure}
\end{frame}

\subsection{Backward process}
\begin{frame}
    \frametitle{Backward process}
    The reverse process of forward process is Backward process.

    EEG measures the potential on the skull surface
    \begin{columns}
        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.4\textheight]{EEG_hat.png}
            \caption{EEG hat}
            \label{fig: EEG hat}
        \end{figure}

        \column{0.5\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[height=0.4\textheight]{EEG_layout.png}
            \caption{EEG layout}
            \label{fig: EEG layout}
        \end{figure}
    \end{columns}
\end{frame}

\section{Source Location}

\begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection, hideothersubsections]
\end{frame}

\subsection{Co-register}
\begin{frame}
    \frametitle{Co-register}
    The first thing is to co-register the two coordinate
    \begin{itemize}
        \item The cortex coordinate, where the source currents are
        \begin{itemize}
            \item Sphere model
            \item Structure MRI model
            \item $\dots$
        \end{itemize}
        \item The EEG cap coordinate, where the EEG sensors are
    \end{itemize}
\end{frame}

\subsection{Gain matrix}
\begin{frame}
    \frametitle{Gain matrix}
    Calculate a \emph{Gain Matrix} using the forward model
    \begin{equation}
        Gain Matrix \quad G \in \mathfrak{R}^{m, n}
    \end{equation}
    where $m$ is the number of EEG sensors, $n$ is the number of source currents.

    $G_{i, j}$ refers the $\vec{E}$ detected by $i^{th}$ EEG sensor caused by $j^{th}$ source current.

    In another word, the EEG signal were considered as a \emph{linear combination} of source currents.
\end{frame}

\subsection{Solution}
\begin{frame}
    \frametitle{Solution}
    The \emph{Source location} problem can be formulated as
    \begin{equation}
        \mathop{\arg\min}_{\vec{W}}
        \left\lVert {\vec{Y} - G \cdot \vec{W}} \right\rVert ^{2} _{2} + loss(\vec{W})
    \end{equation}
    where $\vec{Y} \in \mathfrak{R}^{m, 1}$ is the EEG signal, $\vec{W} \in \mathfrak{R}^{n, 1}$ is the strong of source currents.

    The problem is $\vec{G}$ has more rows than columns, it makes the solution can be variable.

    So, using proper $loss$ function, like \emph{sparse loss} is necessary.
\end{frame}

\end{document}